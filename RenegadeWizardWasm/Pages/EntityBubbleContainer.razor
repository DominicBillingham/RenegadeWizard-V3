@using RenegadeWizardWasm.Core.UserInterface
@using RenegadeWizardWasm.Core.Enums

<div class="entity-bubble-container">
    
    <div class="bubble-list">

        @foreach (var creature in CreatureCards)
        {
            <div class="entity-bubble-wrapper">

                <div class="entity-bubble creature-bubble">
                    
                    @($"{creature.Name} ({creature.Hitpoints}hp) ")

                    @if (creature.Intent != null)
                    {
                        var intentIcon = creature.Intent switch
                        {
                            RenegadeWizardWasm.Core.Enums.Intent.Unknown => "question",
                            RenegadeWizardWasm.Core.Enums.Intent.Attack => "explosion",
                            RenegadeWizardWasm.Core.Enums.Intent.Debuff => "droplet",
                            RenegadeWizardWasm.Core.Enums.Intent.Buff => "fire-flame-curved",
                            _ => "question"
                        };

                        var intentColor = creature.Intent switch
                        {
                            RenegadeWizardWasm.Core.Enums.Intent.Unknown => "color: #FFD700;",
                            RenegadeWizardWasm.Core.Enums.Intent.Attack => "color: #DC143C;",
                            RenegadeWizardWasm.Core.Enums.Intent.Debuff => "color: #9370DB;",
                            RenegadeWizardWasm.Core.Enums.Intent.Buff => "color: #4169E1;",
                            _ => "color: #FFD700;"
                        };

                        <span class="intention-icon">
                            <i class="fa-solid fa-@intentIcon intention-icon" style="@intentColor"></i>
                        </span>
                    }

                </div>

                <div class="entity-card-popup">
                    <div class="entity-card">
                        <div class="entity-header">
                            <div class="entity-name">@creature.Name</div>
                            <div class="header-right">
                                
                                @if (creature.Intent != null)
                                {
                                    <span class="entity-name">@creature.Intent.ToString()</span>
                                }

                            </div>
                        </div>

                        @if (creature.Tags != null && creature.Tags.Any())
                        {
                            <div class="entity-tags">
                                @foreach (var tag in creature.Tags)
                                {
                                    <span class="tag-item">@tag</span>
                                }
                            </div>
                        }

                        @if (!string.IsNullOrEmpty(creature.Description))
                        {
                            <div class="entity-description">
                                @creature.Description
                            </div>
                        }
                    </div>
                </div>
            </div>
        }

        @foreach (var item in ObjectCards)
        {
            <div class="entity-bubble-wrapper">
                <div class="entity-bubble item-bubble">
                    @item.Name
                </div>
                <div class="entity-card-popup">
                    <div class="entity-card">
                        <div class="entity-header">
                            <div class="entity-name">@item.Name</div>
                            @if (item.Hitpoints.HasValue)
                            {
                                <span class="entity-hp">@item.Hitpoints HP</span>
                            }
                        </div>

                        @if (item.Tags != null && item.Tags.Any())
                        {
                            <div class="entity-tags">
                                @foreach (var tag in item.Tags)
                                {
                                    <span class="tag-item">@tag</span>
                                }
                            </div>
                        }

                        @if (!string.IsNullOrEmpty(item.Description))
                        {
                            <div class="entity-description">
                                @item.Description
                            </div>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
</div>

@code {
    [Parameter] public List<TerminalCard> CreatureCards { get; set; } = new();
    [Parameter] public List<TerminalCard> ObjectCards { get; set; } = new();
}
